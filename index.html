<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xyntrio Travel</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <img src="logo.svg" alt="Xyntrio Logo" class="logo">
        <h1>Xyntrio Travel</h1>
        <p>Flights, Hotels & Holidays – All in One Place!</p>
    </header>

    <!-- NAVIGATION -->
    <nav class="navbar">
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">Flights</a></li>
            <li><a href="#">Hotels</a></li>
            <li><a href="#">Holiday Packages</a></li>
            <li><a href="#">Contact</a></li>
        </ul>
    </nav>

    <!-- BOOKING SEARCH SECTION -->
    <section class="booking-section">
        <h2>Book Your Trip</h2>
        <div class="booking-tabs">
            <button class="tab active" onclick="showTab('flights')">Flights</button>
            <button class="tab" onclick="showTab('hotels')">Hotels</button>
        </div>

        <!-- Flight Booking Form -->
        <div id="flights" class="booking-form active">
            <form>
                <label>From (IATA Code):</label>
                <input type="text" placeholder="City or Airport" required>
                <label>To (IATA Code):</label>
                <input type="text" placeholder="Destination" required>
                <label>Departure:</label>
                <input type="date" required>
                <label>Return:</label>
                <input type="date">
                <label>Passengers:</label>
                <input type="number" min="1" value="1" required>
                <button type="submit">Search Flights</button>
            </form>
        </div>

        <!-- Hotel Booking Form -->
        <div id="hotels" class="booking-form" style="display: none;">
            <form>
                <label>City Code (e.g. DEL):</label>
                <input type="text" placeholder="City or Hotel" required>
                <label>Check-in:</label>
                <input type="date" required>
                <label>Check-out:</label>
                <input type="date" required>
                <label>Guests:</label>
                <input type="number" min="1" value="1" required>
                <button type="submit">Search Hotels</button>
            </form>
        </div>
    </section>

    <!-- FOOTER -->
    <footer>
        <p>&copy; 2025 Xyntrio Travel. All rights reserved.</p>
    </footer>

    <script>
        const API_BASE = "https://travelend.onrender.com"; // Your Render backend URL

        function showTab(tab) {
            document.querySelectorAll('.booking-form').forEach(form => form.style.display = 'none');
            document.getElementById(tab).style.display = 'block';
            document.querySelectorAll('.tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function displayResults(data, type) {
            const existing = document.querySelector('.results');
            if (existing) existing.remove();

            const container = document.createElement('div');
            container.className = 'results';
            container.innerHTML = `<h3>${type} Results:</h3>`;

            if (!data || data.length === 0) {
                container.innerHTML += `<p>No ${type.toLowerCase()} found.</p>`;
            } else {
                if (data[0].mock) {
                    container.innerHTML += `<p><em>Showing sample data</em></p>`;
                }
                data.forEach(item => {
                    if (type === 'Flights') {
                        const flight = item.itineraries[0].segments[0];
                        container.innerHTML += `<p>${item.validatingAirlineCodes[0]}: ₹${item.price.total} — ${flight.departure.iataCode} → ${flight.arrival.iataCode}</p>`;
                    } else {
                        const hotel = item.hotel.name || "Hotel";
                        const price = item.offers[0].price.total;
                        container.innerHTML += `<p>${hotel} — from ₹${price}</p>`;
                    }
                });
            }
            document.querySelector('.booking-section').appendChild(container);
        }

        // Flights Search
        document.querySelector('#flights form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const from = e.target.querySelector('input[placeholder="City or Airport"]').value.toUpperCase();
            const to = e.target.querySelector('input[placeholder="Destination"]').value.toUpperCase();
            const date = e.target.querySelector('input[type="date"]').value;

            const res = await fetch(`${API_BASE}/api/flights?from=${from}&to=${to}&date=${date}`);
            const flights = await res.json();
            displayResults(flights, 'Flights');
        });

        // Hotels Search
        document.querySelector('#hotels form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const city = e.target.querySelector('input[placeholder="City or Hotel"]').value.toUpperCase();
            const checkIn = e.target.querySelector('input[type="date"]').value;
            const checkOut = e.target.querySelectorAll('input[type="date"]')[1].value;

            const res = await fetch(`${API_BASE}/api/hotels?city=${city}&checkIn=${checkIn}&checkOut=${checkOut}`);
            const hotels = await res.json();
            displayResults(hotels, 'Hotels');
        });
    </script>
</body>
</html>
